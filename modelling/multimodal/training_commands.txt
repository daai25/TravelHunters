# =============================================================================
# TravelHunters Multi-Modal Training - Terminal Befehle
# =============================================================================
# Alle Befehle bereit zum Kopieren und EinfÃ¼gen
# Datum: 15.07.2025

# =============================================================================
# ðŸš€ SCHNELLSTART - Alles in einem Befehl
# =============================================================================

# Wechsle ins Projektverzeichnis und starte Training
cd /Users/leonakryeziu/PycharmProjects/SummerSchool/TravelHunters/modelling/multimodal && ./train_multimodal.sh

# =============================================================================
# ðŸ“‹ SCHRITT-FÃœR-SCHRITT BEFEHLE
# =============================================================================

# 1. Ins Multimodal-Verzeichnis wechseln
cd /Users/leonakryeziu/PycharmProjects/SummerSchool/TravelHunters/modelling/multimodal

# 2. PrÃ¼fe ob extrahierte Bilder verfÃ¼gbar sind
ls -la ../../../data_acquisition/database/extracted_images/ | head -10

# 3. PrÃ¼fe Anzahl der Trainingsbilder
find ../../../data_acquisition/database/extracted_images -name "*.jpg" -o -name "*.jpeg" -o -name "*.png" | wc -l

# 4. PrÃ¼fe Python-Environment
python --version

# 5. Teste wichtige Pakete
python -c "import numpy, pandas, tensorflow, sklearn, PIL, joblib; print('âœ… Alle Pakete verfÃ¼gbar')"

# 6. FÃ¼hre das Training aus (automatisches Skript)
./train_multimodal.sh

# =============================================================================
# ðŸ”§ MANUELLES TRAINING (falls Skript nicht funktioniert)
# =============================================================================

# 1. Ins Multimodal-Verzeichnis wechseln
cd /Users/leonakryeziu/PycharmProjects/SummerSchool/TravelHunters/modelling/multimodal

# 2. Interaktives Training starten
python multimodal_recommender.py

# Dann wÃ¤hlen Sie:
# "2" fÃ¼r Training
# "y" fÃ¼r BestÃ¤tigung
# "/Users/leonakryeziu/PycharmProjects/SummerSchool/TravelHunters/data_acquisition/database/extracted_images" als Bildverzeichnis

# =============================================================================
# ðŸ§ª NACH DEM TRAINING - Testen und Validieren
# =============================================================================

# 1. PrÃ¼fe ob Modell gespeichert wurde
ls -la *.joblib

# 2. Teste das trainierte Modell
python multimodal_recommender.py

# Dann wÃ¤hlen Sie:
# "1" fÃ¼r Demo
# Geben Sie eine Suchanfrage ein, z.B. "beach hotel with spa"

# 3. ÃœberprÃ¼fe Trainingslog (falls vorhanden)
tail -50 training.log 2>/dev/null || echo "Kein Trainingslog gefunden"

# =============================================================================
# ðŸ” DEBUGGING-BEFEHLE
# =============================================================================

# PrÃ¼fe Systemanforderungen
echo "ðŸ–¥ï¸ System Info:"
uname -a
echo "ðŸ Python:"
python --version
echo "ðŸ“¦ Wichtige Pakete:"
python -c "
import sys
packages = ['numpy', 'pandas', 'tensorflow', 'sklearn', 'PIL', 'joblib']
for pkg in packages:
    try:
        __import__(pkg)
        print(f'âœ… {pkg}')
    except ImportError:
        print(f'âŒ {pkg} fehlt')
"

# PrÃ¼fe verfÃ¼gbaren Speicher
df -h .

# PrÃ¼fe Bilddaten
echo "ðŸ“¸ Bildstatistiken:"
echo "StÃ¤dte: $(ls ../../../data_acquisition/database/extracted_images | wc -l)"
echo "Bilder: $(find ../../../data_acquisition/database/extracted_images -name '*.jpg' -o -name '*.jpeg' -o -name '*.png' | wc -l)"

# Zeige erste 5 StÃ¤dte mit Bildanzahl
echo "ðŸ™ï¸ Erste 5 StÃ¤dte:"
for city in $(ls ../../../data_acquisition/database/extracted_images | head -5); do
    count=$(ls ../../../data_acquisition/database/extracted_images/"$city"/*.jpg ../../../data_acquisition/database/extracted_images/"$city"/*.png 2>/dev/null | wc -l)
    echo "  $city: $count Bilder"
done

# =============================================================================
# ðŸ“š HILFE UND DOKUMENTATION
# =============================================================================

# Zeige Hilfe fÃ¼r das multimodal_recommender Skript
python multimodal_recommender.py --help 2>/dev/null || echo "Keine --help Option verfÃ¼gbar"

# Zeige verfÃ¼gbare Funktionen
python -c "
from multimodal_recommender import *
import inspect
print('ðŸ”§ VerfÃ¼gbare Funktionen:')
for name, obj in globals().items():
    if callable(obj) and not name.startswith('_'):
        print(f'  {name}')
"

# =============================================================================
# âš¡ PERFORMANCE-OPTIMIERUNG
# =============================================================================

# Reduziere Bildanzahl pro Stadt fÃ¼r schnelleres Training (optional)
python -c "
import os
from pathlib import Path

extracted_dir = Path('../../../data_acquisition/database/extracted_images')
max_images = 10  # Maximal 10 Bilder pro Stadt

for city_dir in extracted_dir.iterdir():
    if city_dir.is_dir():
        images = list(city_dir.glob('*.jpg')) + list(city_dir.glob('*.png'))
        if len(images) > max_images:
            print(f'{city_dir.name}: {len(images)} -> {max_images} Bilder')
            # LÃ¶sche Ã¼berschÃ¼ssige Bilder (optional - auskommentiert fÃ¼r Sicherheit)
            # for img in images[max_images:]:
            #     img.unlink()
"

# =============================================================================
# ðŸ”„ WIEDERHOLUNG UND CLEANUP
# =============================================================================

# LÃ¶sche vorherige Trainingsmodelle (falls neu trainiert werden soll)
rm -f *.joblib
rm -f training.log

# Starte sauberes Training
./train_multimodal.sh

# =============================================================================
# ðŸ’¾ BACKUP UND WIEDERHERSTELLUNG
# =============================================================================

# Erstelle Backup der trainierten Modelle
mkdir -p backups/$(date +%Y%m%d_%H%M%S)
cp *.joblib backups/$(date +%Y%m%d_%H%M%S)/ 2>/dev/null || echo "Keine Modelle zum Backup"

# Zeige verfÃ¼gbare Backups
ls -la backups/

# Stelle ein Backup wieder her (BEISPIEL - ersetze mit tatsÃ¤chlichem Backup-Ordner)
# cp backups/20250715_143000/*.joblib .

# =============================================================================
# ðŸ“Š MONITORING WÃ„HREND DES TRAININGS
# =============================================================================

# In einem separaten Terminal: Ãœberwache Speicherverbrauch
# watch -n 5 'ps aux | grep python | grep -v grep'

# Ãœberwache Festplattenspeicher
# watch -n 10 'df -h .'

# Zeige Python-Prozesse
# ps aux | grep python | grep -v grep

# =============================================================================
# âœ… FERTIG!
# =============================================================================

echo "ðŸŽ‰ Alle Terminal-Befehle bereit!"
echo "Beginnen Sie mit dem Schnellstart-Befehl oben oder"
echo "folgen Sie den Schritt-fÃ¼r-Schritt Anweisungen."
